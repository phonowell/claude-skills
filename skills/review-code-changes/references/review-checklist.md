# 四维审查规则

## 真实性
- 问题是否对应当前需求与变更目标
- 连续重复逻辑 <3 次应抽象或合并
- 禁止无依据配置化

## 正确性
- 类型/边界/依赖正确，减少断言与非空断言
- 覆盖空值、异常分支、回滚路径
- 关键改动需跑相关测试

## 优雅性
- 命名准确，声明与消费相邻
- 结构清晰，跨层依赖最小化
- 保持与现有代码风格一致

## 结构治理（防屎山）
- 禁止“功能可跑但结构失控”的堆叠式补丁
- 重复逻辑连续出现 ≥3 次必须抽象或合并
- 长函数、跨域耦合、碎片化文件需在本轮修复或登记

## 行数治理
- 代码单元（函数/类/模块片段）目标区间：30~200 行
- >200 行：按职责拆分为同域可独立验证单元
- <30 行：仅承载零碎同域逻辑时并入相邻同域单元
- 拆分或合并后需保持行为不变与测试可达

## 最小化
- 删除冗余包装与死代码
- 合并重复逻辑，优先内联低复用片段
- 不引入与目标无关改动

## 严重级别
- P0：安全漏洞/数据破坏/明确正确性错误，阻塞合并
- P1：逻辑错误/明显回归风险，合并前修复
- P2：可维护性缺陷，本轮修复或登记后续
- P3：风格建议，可选优化
